-- ========================================
-- The KreOS 3.0 Skylark System Info
-- Written by kornichen
-- Lastly modified on 2nd April 2015
-- Licensed under General Public License V3
-- ========================================

os.loadAPI("/system/apis/skylark")

local args = { ... }

if args[1] ~= "settings" then
	error("This has to be started from KreOS.")
end

local pages, buttons, inputboxes, labels, checkboxes, scrollbars, images, render, action = skylark.init()
local w, h = term.getSize()

pages:create("config_info", "System Info", true, colors.white, true)

buttons:create("btnCfgClockSettings", "config_info", true, 2, 2, "Settings", colors.cyan, colors.gray, function()
	if inputboxes:getValue("ibComputerLabel") == "" then
		os.setComputerLabel(nil)
	else
		os.setComputerLabel(inputboxes:getValue("ibComputerLabel"))
	end
	pages:disable("config_info")
	error()
end)

images:create("imgInfoKreOS", "config_info", true, 2, 5, paintutils.loadImage("/system/images/info_kreos"), function() end)
labels:create("lbKreOS", "config_info", true, 30, 5, "KreOS 3.01 Skylark", colors.black, colors.white)
labels:create("lbKreOSinfo1", "config_info", true, 30, 7, "Written by kornichen", colors.black, colors.white)
labels:create("lbKreOSinfo2", "config_info", true, 30, 9, "Licensed under General", colors.black, colors.white)
labels:create("lbKreOSinfo3", "config_info", true, 30, 10, "Public License V3", colors.black, colors.white)
labels:create("lbComputerLaberl", "config_info", true, 2, 13, "Label:", colors.black, colors.white)
inputboxes:create("ibComputerLabel", "config_info", true, 9, 13, 19, colors.black, colors.lightGray)
inputboxes:changeValue("ibComputerLabel", os.getComputerLabel() or "")
labels:create("lbComputerID", "config_info", true, 30, 13, "ID: " .. os.getComputerID(), colors.black, colors.white)
labels:create("lbComputerID", "config_info", true, 2, 15, "Free storage: " .. (fs.getFreeSpace("/") / 1024) .. " KB", colors.black, colors.white)

while true do
	render:all(pages, buttons, inputboxes, labels, checkboxes, images)
	action:pullEvent(pages, buttons, inputboxes, checkboxes, images)
end